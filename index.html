<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Mitarbeiter Dropdown</title>
</head>
<body>

  <label for="mitarbeiter">Mitarbeiter ausw√§hlen:</label>
  <select id="mitarbeiter">
    <option>L√§dt...</option>
  </select>

  <script>
    const DROPDOWN_ID = "mitarbeiter";
    const FLOW_URL = "https://prod-86.westeurope.logic.azure.com:443/workflows/2e0a97d831874a0288bf9e6ce0e65fad/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=CsOAnwfwyiFSphxxAwLl0dY1P-jbSxARv_58dDRWPMU";

    async function ladeMitarbeiter() {
      const select = document.getElementById(DROPDOWN_ID);
      select.innerHTML = "<option>Aktualisierung l√§uft</option>";

      try {
        const response = await fetch(FLOW_URL, {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: "{}"
        });

        const data = await response.json();
        let mitarbeiterListe = data.employees || [];

        // üîΩ Sortierung nach Benutzername hinzuf√ºgen
        mitarbeiterListe.sort((a, b) => {
          const nameA = a.Benutzername?.toLowerCase() || "";
          const nameB = b.Benutzername?.toLowerCase() || "";
          return nameA.localeCompare(nameB);
        });

        // Dropdown bef√ºllen
        select.innerHTML = "<option>Bitte ausw√§hlen</option>";
        mitarbeiterListe.forEach(eintrag => {
          const name = eintrag.Benutzername || "Unbenannt";
          const option = document.createElement("option");
          option.text = name;
          option.value = name;
          select.appendChild(option);
        });

      } catch (error) {
        console.error("Fehler beim Abruf:", error);
        select.innerHTML = "<option>Fehler beim Laden</option>";
      }
    }

    ladeMitarbeiter();
  </script>

</body>
</html>
